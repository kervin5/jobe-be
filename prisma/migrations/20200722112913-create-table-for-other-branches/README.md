# Migration `20200722112913-create-table-for-other-branches`

This migration has been generated by Kervin Vasquez at 7/22/2020, 11:29:13 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "myexactjobs-prisma-prod"."_UserAccessToBranch" (
"A" text  NOT NULL ,
"B" text  NOT NULL )

CREATE UNIQUE INDEX "_UserAccessToBranch_AB_unique" ON "myexactjobs-prisma-prod"."_UserAccessToBranch"("A","B")

CREATE  INDEX "_UserAccessToBranch_B_index" ON "myexactjobs-prisma-prod"."_UserAccessToBranch"("B")

ALTER TABLE "myexactjobs-prisma-prod"."_UserAccessToBranch" ADD FOREIGN KEY ("A")REFERENCES "myexactjobs-prisma-prod"."Branch"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "myexactjobs-prisma-prod"."_UserAccessToBranch" ADD FOREIGN KEY ("B")REFERENCES "myexactjobs-prisma-prod"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200715113528-make-phone-unique..20200722112913-create-table-for-other-branches
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 enum UserStatus {
   ACTIVE
@@ -91,8 +91,10 @@
   description String?
   jobs  Job[]
   users User[]
+
+  usersWithAccess User[] @relation("UserAccessToBranch")
 }
 model Category {
   id           String        @id @default(cuid())
@@ -162,8 +164,9 @@
   cronTask   JobCronTask? @relation(fields: [cronTaskId], references: [id])
   perks Perk[] @relation(references: [id])
   views Int    @default(0)
+
 }
 model JobCronTask {
   id       String   @id @default(cuid())
@@ -239,10 +242,11 @@
   favorites    Favorite[]
   roleId       String        @map("role")
   role         Role          @relation(fields: [roleId], references: [id])
-  branchId String? @map("branch")
-  branch   Branch? @relation(fields: [branchId], references: [id])
+  branchId      String?  @map("branch")
+  branch        Branch?  @relation(fields: [branchId], references: [id])
+  otherBranches Branch[] @relation("UserAccessToBranch")
   resumes              Resume[]
   resetToken           String?
   resetTokenExpiry     Float?
```


